import{d as I,C as A,L as F,r as R,k as B,l as O,M as H,N as M,O as z,P as G,Q as q,R as N,S as Q,T as D,U as W,i as y,V,W as Y,h as X,p as Z,X as J,Y as K,Z as ee,u as te,c as C,b as a,e as ae,B as ne,t as S,j as E,F as le,m as re,y as se,z as ie,n as j,w as $,E as oe,o as w,v as ue}from"./a6n2H657.js";import{S as T}from"./BQIkj5Wb.js";const ce=(...l)=>l.find(h=>h!==void 0);function de(l){const h=l.componentName||"NuxtLink";function f(e){return typeof e=="string"&&e.startsWith("#")}function P(e,i,o){const s=o??l.trailingSlash;if(!e||s!=="append"&&s!=="remove")return e;if(typeof e=="string")return L(e,s);const d="path"in e&&e.path!==void 0?e.path:i(e).path;return{...e,name:void 0,path:L(d,s)}}function x(e){const i=A(),o=X(),s=y(()=>!!e.target&&e.target!=="_self"),d=y(()=>{const t=e.to||e.href||"";return typeof t=="string"&&V(t,{acceptRelative:!0})}),p=N("RouterLink"),b=typeof p!="string"?p.useLink:void 0,m=y(()=>{if(e.external)return!0;const t=e.to||e.href||"";return typeof t=="object"?!1:t===""||d.value}),u=y(()=>{const t=e.to||e.href||"";return m.value?t:P(t,i.resolve,e.trailingSlash)}),g=m.value?void 0:b?.({...e,to:u}),n=y(()=>{const t=e.trailingSlash??l.trailingSlash;if(!u.value||d.value||f(u.value))return u.value;if(m.value){const k=typeof u.value=="object"&&"path"in u.value?D(u.value):u.value,r=typeof k=="object"?i.resolve(k).href:k;return L(r,t)}return typeof u.value=="object"?i.resolve(u.value)?.href??null:L(Y(o.app.baseURL,u.value),t)});return{to:u,hasTarget:s,isAbsoluteUrl:d,isExternal:m,href:n,isActive:g?.isActive??y(()=>u.value===i.currentRoute.value.path),isExactActive:g?.isExactActive??y(()=>u.value===i.currentRoute.value.path),route:g?.route??y(()=>i.resolve(u.value)),async navigate(t){await Z(n.value,{replace:e.replace,external:m.value||s.value})}}}return I({name:h,props:{to:{type:[String,Object],default:void 0,required:!1},href:{type:[String,Object],default:void 0,required:!1},target:{type:String,default:void 0,required:!1},rel:{type:String,default:void 0,required:!1},noRel:{type:Boolean,default:void 0,required:!1},prefetch:{type:Boolean,default:void 0,required:!1},prefetchOn:{type:[String,Object],default:void 0,required:!1},noPrefetch:{type:Boolean,default:void 0,required:!1},activeClass:{type:String,default:void 0,required:!1},exactActiveClass:{type:String,default:void 0,required:!1},prefetchedClass:{type:String,default:void 0,required:!1},replace:{type:Boolean,default:void 0,required:!1},ariaCurrentValue:{type:String,default:void 0,required:!1},external:{type:Boolean,default:void 0,required:!1},custom:{type:Boolean,default:void 0,required:!1},trailingSlash:{type:String,default:void 0,required:!1}},useLink:x,setup(e,{slots:i}){const o=A(),{to:s,href:d,navigate:p,isExternal:b,hasTarget:m,isAbsoluteUrl:u}=x(e),g=F(!1),n=R(null),t=v=>{n.value=e.custom?v?.$el?.nextElementSibling:v?.$el};function k(v){return!g.value&&(typeof e.prefetchOn=="string"?e.prefetchOn===v:e.prefetchOn?.[v]??l.prefetchOn?.[v])&&(e.prefetch??l.prefetch)!==!1&&e.noPrefetch!==!0&&e.target!=="_blank"&&!pe()}async function r(v=B()){if(g.value)return;g.value=!0;const _=typeof s.value=="string"?s.value:b.value?D(s.value):o.resolve(s.value).fullPath,c=b.value?new URL(_,window.location.href).href:_;await Promise.all([v.hooks.callHook("link:prefetch",c).catch(()=>{}),!b.value&&!m.value&&W(s.value,o).catch(()=>{})])}if(k("visibility")){const v=B();let _,c=null;O(()=>{const U=fe();H(()=>{_=M(()=>{n?.value?.tagName&&(c=U.observe(n.value,async()=>{c?.(),c=null,await r(v)}))})})}),z(()=>{_&&G(_),c?.(),c=null})}return()=>{if(!b.value&&!m.value&&!f(s.value)){const c={ref:t,to:s.value,activeClass:e.activeClass||l.activeClass,exactActiveClass:e.exactActiveClass||l.exactActiveClass,replace:e.replace,ariaCurrentValue:e.ariaCurrentValue,custom:e.custom};return e.custom||(k("interaction")&&(c.onPointerenter=r.bind(null,void 0),c.onFocus=r.bind(null,void 0)),g.value&&(c.class=e.prefetchedClass||l.prefetchedClass),c.rel=e.rel||void 0),q(N("RouterLink"),c,i.default)}const v=e.target||null,_=ce(e.noRel?"":e.rel,l.externalRelAttribute,u.value||m.value?"noopener noreferrer":"")||null;return e.custom?i.default?i.default({href:d.value,navigate:p,prefetch:r,get route(){if(!d.value)return;const c=new URL(d.value,window.location.href);return{path:c.pathname,fullPath:c.pathname,get query(){return Q(c.search)},hash:c.hash,params:{},name:void 0,matched:[],redirectedFrom:void 0,meta:{},href:d.value}},rel:_,target:v,isExternal:b.value||m.value,isActive:!1,isExactActive:!1}):null:q("a",{ref:n,href:d.value||null,rel:_,target:v,onClick:c=>{if(!(b.value||m.value))return c.preventDefault(),e.replace?o.replace(d.value):o.push(d.value)}},i.default?.())}}})}const ve=de(ee);function L(l,h){const f=h==="append"?J:K;return V(l)&&!l.startsWith("http")?l:f(l,!0)}function fe(){const l=B();if(l._observer)return l._observer;let h=null;const f=new Map,P=(e,i)=>(h||=new IntersectionObserver(o=>{for(const s of o){const d=f.get(s.target);(s.isIntersecting||s.intersectionRatio>0)&&d&&d()}}),f.set(e,i),h.observe(e),()=>{f.delete(e),h?.unobserve(e),f.size===0&&(h?.disconnect(),h=null)});return l._observer={observe:P}}const he=/2g/;function pe(){const l=navigator.connection;return!!(l&&(l.saveData||he.test(l.effectiveType)))}const me={class:"container px-3 mb-4"},ge={class:"content-card"},be={class:"card-header"},ye={class:"card-body"},ke={key:0,class:"text-center py-5"},_e={key:1,class:"content-card p-3 p-md-4"},xe={class:"alert alert-danger"},Ce={key:2},we={class:"table-responsive"},Pe={class:"table app-table align-middle"},Se={class:"d-flex justify-content-center gap-2"},Re=["onClick"],Le=["onClick"],Be=["onClick"],Te={key:0},Ae={class:"card-footer"},qe={class:"search-container"},Ne={key:0,class:"pagination-container"},De={class:"pagination"},Ee={class:"page-item pagination-summary","aria-current":"page"},je={class:"page-link"},Oe=I({__name:"index",setup(l){const{$api:h}=B();te({title:"Daftar Produk"});const f=R([]),P=R(!0),x=R(null),e=oe(),i=R(""),o=R(1),s=R(10),d=y(()=>{if(!i.value)return f.value;const n=i.value.toLowerCase();return f.value.filter(t=>t.name.toLowerCase().includes(n))}),p=y(()=>Math.ceil(d.value.length/s.value)),b=y(()=>{o.value>p.value&&p.value>0&&(o.value=1);const n=(o.value-1)*s.value,t=n+s.value;return d.value.slice(n,t)}),m=n=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(n),u=n=>{n>=1&&n<=p.value&&(o.value=n)},g={view:n=>e.push(`/product/${n}`),edit:n=>e.push(`/dashboard/product/${n}`),delete:(n,t)=>{T.fire({title:"Anda Yakin?",text:`Produk "${t}" akan dihapus secara permanen!`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Ya, hapus!",cancelButtonText:"Batal"}).then(async k=>{if(k.isConfirmed)try{const r=await h(`/api/v2/product/${n}`,{method:"DELETE"});if(!r.status)throw new Error(r.msg||"Gagal menghapus produk.");f.value=f.value.filter(v=>v._id!==n),T.fire("Dihapus!","Produk telah berhasil dihapus.","success")}catch(r){T.fire("Gagal!",r.message||"Terjadi kesalahan saat mencoba menghapus produk.","error")}})}};return O(async()=>{try{const n=await h("/api/v2/products");if(!n.status){x.value=n.msg;return}f.value=n.data}catch{x.value="Gagal memuat data produk."}finally{P.value=!1}}),(n,t)=>{const k=ve;return w(),C("div",me,[a("div",ge,[a("div",be,[t[4]||(t[4]=a("h5",null,"Daftar Produk",-1)),ae(k,{to:"/dashboard/add-product",class:"btn btn-sm btn-custom-accent"},{default:ne(()=>t[3]||(t[3]=[a("i",{class:"bi bi-plus-lg me-1"},null,-1),ue(" Tambah Baru ",-1)])),_:1,__:[3]})]),a("div",ye,[P.value?(w(),C("div",ke,t[5]||(t[5]=[a("div",{class:"spinner-border product-loader-spinner",role:"status"},null,-1),a("p",{class:"mt-3"},"Memuat produk...",-1)]))):x.value?(w(),C("div",_e,[a("div",xe,S(x.value),1)])):(w(),C("div",Ce,[a("div",we,[a("table",Pe,[t[10]||(t[10]=a("thead",null,[a("tr",null,[a("th",{scope:"col"},"ID"),a("th",{scope:"col"},"Nama Produk"),a("th",{scope:"col"},"Harga"),a("th",{scope:"col"},"Terjual"),a("th",{scope:"col",class:"text-center"},"Aksi")])],-1)),a("tbody",null,[(w(!0),C(le,null,re(b.value,r=>(w(),C("tr",{key:r._id},[a("td",null,S(r._id),1),a("td",null,S(r.name),1),a("td",null,S(m(r.price)),1),a("td",null,S(r.sales)+"x",1),a("td",null,[a("div",Se,[a("button",{class:"btn btn-sm btn-action-view",title:"Lihat",onClick:v=>g.view(r._id)},t[6]||(t[6]=[a("i",{class:"bi bi-eye-fill"},null,-1)]),8,Re),a("button",{class:"btn btn-sm btn-action-edit",title:"Edit",onClick:v=>g.edit(r._id)},t[7]||(t[7]=[a("i",{class:"bi bi-pencil-fill"},null,-1)]),8,Le),a("button",{class:"btn btn-sm btn-action-delete",title:"Hapus",onClick:v=>g.delete(r._id,r.name)},t[8]||(t[8]=[a("i",{class:"bi bi-trash-fill"},null,-1)]),8,Be)])])]))),128)),b.value.length===0?(w(),C("tr",Te,t[9]||(t[9]=[a("td",{colspan:5,class:"text-center text-muted py-4"}," Tidak ada produk yang cocok dengan pencarian Anda. ",-1)]))):E("",!0)])])]),a("div",Ae,[a("div",qe,[t[11]||(t[11]=a("i",{class:"bi bi-search search-icon"},null,-1)),se(a("input",{type:"search","onUpdate:modelValue":t[0]||(t[0]=r=>i.value=r),class:"form-control search-input",placeholder:"Cari produk..."},null,512),[[ie,i.value]])]),p.value>1?(w(),C("nav",Ne,[a("ul",De,[a("li",{class:j(["page-item",{disabled:o.value===1}])},[a("a",{class:"page-link",href:"#",onClick:t[1]||(t[1]=$(r=>u(o.value-1),["prevent"]))},"Prev")],2),a("li",Ee,[a("span",je,S(o.value)+" / "+S(p.value),1)]),a("li",{class:j(["page-item",{disabled:o.value===p.value}])},[a("a",{class:"page-link",href:"#",onClick:t[2]||(t[2]=$(r=>u(o.value+1),["prevent"]))},"Next")],2)])])):E("",!0)])]))])])])}}});export{Oe as default};
